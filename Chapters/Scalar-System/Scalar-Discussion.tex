\section{General formula for the $M$-matrix of a finite period graph} \label{sec:ScalarDiscussion}
Having obtained the quantum graph problem \eqref{eq:SingularWaveEqnQGProblem}, we turn our attention to determining the eigenvalues $z := \omega^2$.
The advantage of \eqref{eq:SingularWaveEqnQGProblem} over working directly with \eqref{eq:SingularScalarWaveEqn} is that we can now use the $M$-matrix (introduced in section \ref{ssec:MMatrix}) as a tool in our analysis.
In this section we contextualise the theory introduced in section \ref{ssec:MMatrix}, showing how it is employed for studying the spectrum of \eqref{eq:SingularWaveEqnQGProblem} and thus $\sigma\bracs{-\laplacian_{\dddmes}^{\qm}}$.
In doing so, we provide a general formula for the $M$-matrix in terms of the underlying (period) graph on which \eqref{eq:SingularWaveEqnQGProblem} is posed.
We will follow up on this in section \ref{sec:ScalarExamples}, where we provide some explicit examples of quantum graph problems that can be solved by employing the $M$-matrix in the manner discussed below.

\tstk{spectral param in BCs discussion comes here --- might need to be re-referenced. Also, Kuchment-Zeng and Exner-Post touch on this association somewhat}
One will note that only $\alpha_j$ appears in the Robin-like condition in \eqref{eq:GraphLaplacianExample}, but $\alpha_j\omega^2$ is present on the right hand side of \eqref{eq:SingularWaveEqnQGProblem}.
As was raised in section \ref{ssec:Intro-ThinStructures}, the problem \eqref{eq:SingularWaveEqnQGProblem} belongs to the class of problems with generalised resolvents.
In section \ref{ssec:MMatrix} we introduced the $M$-matrix in a more familiar setting, with no $\omega^2$-dependence in the vertex conditions.
However the analysis of the spectrum of $-\laplacian_{\dddmes}^{\qm}$ can be carried by replacing the matrix $B$ (in section \ref{ssec:MMatrix}) with $\omega^2 B$, as will be done in section \ref{ssec:MMatrixConsequences}.
Justification lies in the observation that introducing explicit $\omega^2$-dependence should not affect the (structure of) the arguments in the supporting theory, and consequentially the conclusions that can be drawn are robust with respect to the aforementioned alteration to $B$ --- see \cite[page 1846]{cherednichenko2018effective} (concerning the results of \tstk{Ryzhov, V.: Weyl-Titchmarsh function of an abstract boundary value problem, operator colligations, and linear systems with boundary control. Complex Anal. Oper. Theory 3(1), 289â€“322 (2009)}) and references therein.
We do remark here though that a formal argument to justify methodology based on the $M$-matrix and boundary triples (in the context of generalised resolvents) has not been carried out in the literature.
As such it remains open to investigation, but would closely follow and resemble arguments that are already available (and form the basis for the theory presented in section \ref{ssec:MMatrix}).
If one has reservations about this ``gap" in the available theory, an alternative to analysing a problem with generalised resolvents directly is explored in \cite[Section 6]{cherednichenko2017norm}.
One could look to transform a problem with $\omega^2$-dependent $\delta$-type vertex condition (like \eqref{eq:SingularWaveEqnQGProblem}) into a problem with $\omega^2$-independent $\delta'$-type vertex conditions.
This comes at the cost of having to determine the appropriate (unitary) transform to apply to \eqref{eq:SingularWaveEqnQGProblem}, but the theory of section \ref{ssec:MMatrix} would apply to the transformed problem, could be used to analyse the spectrum, and then the inverse transform applied.

\subsection{General formula for the $M$-matrix} \label{ssec:MMatrixResult}
One of the foremost advantages of the $M$-matrix is that we can explicitly (and analytically) compute its entries for any (finite period) metric graph $\graph$ on which the system \eqref{eq:SingularWaveEqnQGProblem} is posed.
The proposition allows for $\graph$ to possess looping edges, although this is largely for completeness because when we come to use the $M$-matrix to determine the eigenvalues of \eqref{eq:SingularWaveEqnQGProblem}, we will want to introduce \emph{artificial vertices} (section \ref{ssec:ArtificialVertices}) to break these loops.
The following proposition provides the entries of the $M$-matrix.
\begin{prop}[$M$-matrix entries] \label{prop:M-MatrixEntries}
	Let $\graph=\bracs{\vertSet,\edgeSet}$ be an embedded graph on which the problem \eqref{eq:SingularWaveEqnQGProblem} is posed.
	Suppose that $\dmap u = e_k$ where $e_k$ is the $k$\textsuperscript{th} canonical unit vector in $\complex^{\abs{\vertSet}}$.
	Then the $j$\textsuperscript{th} entry of $\nmap u$, and hence the $jk$\textsuperscript{th} entry in the $M$-matrix, is given by
	\begin{align*}
		\bracs{\nmap u}_j &= 
		\begin{cases}
			0,	
			& j \not\con k, \\[5pt]
			\sum_{j\conLeft k} \omega \e^{\rmi\qm_{jk}l_{jk}} \csc\bracs{l_{jk}\omega} 
			+ \sum_{j\conRight k} \omega \e^{-\rmi\qm_{kj}l_{kj}} \csc\bracs{l_{kj}\omega},
			& j\neq k, \ j\con k, \\[5pt]
			- \sum_{\substack{j\con l \\ j\neq l}} \omega\cot\bracs{l_{jl}\omega}
			- 2\omega\sum_{j\conLeft j} \clbracs{ \cot\bracs{l_{jj}\omega} - \cos\bracs{\qm_{jj}l_{jj}}\csc\bracs{l_{jj}\omega} },
			& j=k.
		\end{cases}
	\end{align*}
\end{prop}
Note the choice of $j\conLeft j$ in the contributions from loops is simply a convention, $j\conRight j$ is equivalent here.
Also recall the convention for summing over $j\con k$:
\begin{align*}
	\sum_{j\con k} \omega\cot\bracs{l_{jk}\omega} &= \sum_{j\conLeft k} \omega\cot\bracs{l_{jk}\omega}	+ \sum_{j\conRight k} \omega\cot\bracs{l_{kj}\omega}
\end{align*}
\begin{proof}
	The proof below is an explicit computation, similar to that in \cite{ershova2014isospectrality} with adjustments for the dependence on $\qm$.
	
	We first write the general form of the edge solution $u^{(jk)}$ from \eqref{eq:SingularWaveEqnQGProblem-1}:
	\begin{align} \label{eq:EdgeEqnGeneralSolution}
		u^{(jk)} &= \e^{-\rmi\qm_{jk}t}\bracs{ C_{+}^{(jk)}\e^{-\rmi\omega x} + C_{-}^{(jk)}\e^{\rmi\omega x} },
		\quad C_{+}^{(jk)}, C_{-}^{(jk)}\in\complex.
	\end{align}
	Since the $M$-matrix maps $\complex^{\abs{\vertSet}}$ to $\complex^{\abs{\vertSet}}$, it is sufficient to determine its action on the canonical basis of $\complex^{\abs{\vertSet}}$.
	So for each fixed $k\in\clbracs{1,...,\abs{\vertSet}}$ we set $\dmap u = e_k$.
	This provides us with sufficient Dirichlet data to solve \eqref{eq:SingularWaveEqnQGProblem-1} on each edge and eliminate the constants $C_{+}^{(jk)}$, $C_{-}^{(jk)}$ in \eqref{eq:EdgeEqnGeneralSolution}, obtaining
	\begin{align*}
		j\not\con k &\implies
		\begin{cases}
			u_{jk}(x) = 0, \\
			u_{kj}(x) = 0,
		\end{cases} \\
		j\neq k, \ j\con k &\implies
		\begin{cases}
			u_{jk}(x) = \e^{-\rmi\qm_{jk}\bracs{x-l_{jk}}}\csc\bracs{\omega l_{jk}}\sin\bracs{\omega x}, \\
			u_{kj}(x) = \e^{-\rmi\qm_{kj}x}\csc\bracs{\omega l_{kj}}\sin\bracs{\omega \bracs{l_{kj}-x}},
		\end{cases} \\
		j = k &\implies 
		\begin{cases}
			u_{jj}(t) = \e^{-\rmi\qm_{jj}x} \bracs{ \e^{-\rmi\omega x} + \sqbracs{\e^{\rmi\qm_{jj}l_{jj}}-\e^{-\rmi\omega l_{jj}}}\csc\bracs{\omega l_{jj}}\sin\bracs{\omega x}  },
		\end{cases}
	\end{align*}
	This in turn enables us to explicitly differentiate the expressions for $u_{jk}$, and read off the values of $\bracs{\pdiff{}{n}+\rmi\qm_{jk}}u_{jk}$ at the vertices.
	In the case $j\not\con k$, we obviously get zero contribution from the edges $I_{jk}$ and $I_{kj}$.
	The case $j\neq k, \ j\con k$, yields the following contributions from the edges $I_{jk}$ and $I_{kj}$:
	\begin{align*}
		\bracs{\pdiff{}{n}+\rmi\qm_{jk}}u^{(jk)}\bracs{v_j} = -\omega \e^{\rmi\qm_{jk}l_{jk}}\csc\bracs{\omega l_{jk}}, 
		&\qquad \bracs{\pdiff{}{n}+\rmi\qm_{jk}}u^{(jk)}\bracs{v_k} = \omega\cot\bracs{\omega l_{jk}}, \\
		\bracs{\pdiff{}{n}+\rmi\qm_{kj}}u^{(kj)}\bracs{v_j} = -\omega \e^{-\rmi\qm_{kj}l_{kj}}\csc\bracs{\omega l_{kj}}, 
		&\qquad \bracs{\pdiff{}{n}+\rmi\qm_{kj}}u^{(kj)}\bracs{v_k} = \omega\cot\bracs{\omega l_{kj}}.
	\end{align*}
	Finally, when considering the case $j=k$, the contribution to $\bracs{\nmap u}_j$ from loops $I_{jj}$ in the graph also requires us to compute
	\begin{align*}
		-\lim_{x\rightarrow0}\bracs{\bracs{u^{(jj)}}'+i\qm_{jj}u^{(jj)}}(x) + \lim_{x\rightarrow l_{jj}} & \bracs{\bracs{u^{(jj)}}'+i\qm_{jj}u^{(jj)}}(x) \\
		&\qquad = 2\omega\bigl( \cot\bracs{\omega l_{jj}} - \cos\bracs{\qm_{jj}l_{jj}}\csc\bracs{\omega l_{jj}} \bigr).	
	\end{align*}
	We then use the formula
	\begin{align*}
		\bracs{\nmap u}_j &= -\sum_{j\con l} \bracs{\pdiff{}{n}+\rmi\qm_{jl}}u^{(jl)}\bracs{v_j},
	\end{align*}
	which yields the desired result for $\bracs{\nmap u}_j$.
	Since $M(\dmap u) = \nmap u$, and the $e_k$ are a basis for $\complex^{\abs{V}}$, we have also deduced the $k^{\text{th}}$ column of the $M$-matrix.
\end{proof}
Proposition \ref{prop:M-MatrixEntries} also explicitly demonstrates that the $M$-matrix (in the context of \eqref{eq:SingularWaveEqnQGProblem}) is parametrised by $\qm$, and so we shall denote it by $M_{\qm}$ henceforth.
The dependence of $M_\qm$ on $\qm$ is due to our decision to specify our singular structure as an embedded, periodic metric graph and then apply the Gelfand transform (see section \ref{ssec:MMatrix}).
In the following section, we continue our analysis of the $M$-matrix and outline how it can be used to recover the eigenvalues $z=\omega^2$ of \eqref{eq:SingularWaveEqnQGProblem}.

\subsection{Consequences of Proposition \ref{prop:M-MatrixEntries}} \label{ssec:MMatrixConsequences}
Whilst proposition \ref{prop:M-MatrixEntries} provides an explicit form for the entries of the $M$-matrix,  it is not the most convenient when looking for a method for determining the spectrum of \eqref{eq:SingularWaveEqnQGProblem}.
Proposition \ref{prop:M-MatrixEntries} does however show that $M_\qm$ is meromorphic, and thus has the following decomposition:
\begin{cory} \label{cory:M-MatrixEntriesNoPoles}
	Let $G^{(1)}_\qm\bracs{\omega}$ have entries defined by
	\begin{align*}
		\bracs{G^{(1)}_\qm}_{jk} &= 
		\begin{cases}
			\!\begin{aligned}
				&0,
			\end{aligned}			
			& j \not\con k, \\
			\!\begin{aligned}
				&\sum_{j\conLeft k} \bracs{ \e^{\rmi\qm_{jk}l_{jk}} \prod_{v_l\in\vertSet}\prod_{\substack{ l\conLeft m \\ \bracs{l,m} \neq \bracs{j,k} }}\sin\bracs{l_{lm}\omega} }
				\\ &\quad + \sum_{j\conRight k} \bracs{ \e^{-\rmi\qm_{kj}l_{kj}} \prod_{v_l\in\vertSet}\prod_{\substack{l\conLeft m \\ \bracs{l,m} \neq \bracs{k,j} }}\sin\bracs{l_{lm}\omega} },
			\end{aligned}
			& j\neq k, \ j\con k, \\
			\!\begin{aligned}
				&- \sum_{\substack{j\con l \\ j\neq l}} \bracs{ \cos\bracs{l_{jl}\omega}\prod_{v_m\in\vertSet}\prod_{\substack{ m\conLeft n \\ \bracs{m,n}\neq\bracs{j,l} }}\sin\bracs{l_{mn}\omega} }
				\\ &\quad - 2\sum_{j\conLeft j} \bracs{ \sqbracs{ \prod_{v_l\in\vertSet}\prod_{\substack{l\conLeft m \\ \bracs{l,m}\neq\bracs{j,j} }}\sin\bracs{l_{lm}\omega} }\bigl[ \cos\bracs{l_{jj}\omega} - \cos\bracs{\qm_{jj}l_{jj}} \bigr] },
			\end{aligned}
			& j=k,
		\end{cases}
	\end{align*}
	and set
	\begin{align*}
		G^{(2)}\bracs{\omega} &= \prod_{v_j\in\vertSet} \prod_{j\conLeft k}\sin\bracs{l_{jk}\omega}.
	\end{align*}
	Further define
	\begin{align*}
		H^{(1)}_{\qm}(z) &:= 
		\begin{cases} 
			\omega G_\qm^{(1)}(\omega), & \abs{\edgeSet} \text{ is even}, \\
			G_\qm^{(1)}(\omega), & \abs{\edgeSet} \text{ is odd},
		\end{cases} \\
		H^{(2)}(z) &:=
		\begin{cases}
			G^{(2)}(\omega), & \abs{\edgeSet} \text{ is even}, \\
			\omega^{-1} G^{(2)}(\omega), & \abs{\edgeSet} \text{ is odd}.
		\end{cases}
	\end{align*}
	Then the functions $H^{(1)}_{\qm}(z)$ and $H^{(2)}(z)$ are analytic in $z:=\omega^2$ and we have
	\begin{align*}
		M_\qm\bracs{z} &= \bracs{ H^{(2)}\bracs{z} }^{-1} H^{(1)}_\qm\bracs{z}.
	\end{align*}
\end{cory}
The product notation should be understood analogously to the summation notation over $j\con k$ introduced in section \ref{sec:QuantumGraphs}.
The zeros of $H^{(2)}$ exactly coincide with the poles of $M_\qm$, both $H^{(1)}_\qm$ and $H^{(2)}$ are analytic, and the matrix $H^{(1)}_\qm$ even has its entry at position $jk$ bounded (uniformly in $\omega$) by the number of (direct) connections between $v_j$ and $v_k$.

Recall that (section \ref{ssec:MMatrix}) we need to determine those $z$ for which the matrix $M_\qm(z)-B(z)$ has at least one zero eigenvalue, where we have $B(z) = -z\alpha$.
Now let $\beta_j^{\qm}\bracs{z}, j\in\clbracs{1,...,\abs{\vertSet}}$ denote the eigenvalue branches of the matrix $M_\qm(z)-B(z)$.
Also set 
\begin{align*}
	\mathfrak{M}_\qm(z) = H^{(1)}_\qm(z) - H^{(2)}(z)B(z),
\end{align*}
and let $\widetilde{\beta}_j^{\qm}\bracs{z}, j\in\clbracs{1,...,\abs{\vertSet}}$ denote the eigenvalue branches of $\mathfrak{M}_\qm$.
With the poles removed, and the entries of $\mathfrak{M}_\qm$ being continuous (even smooth on $\bracs{0,\infty}$) functions of $\omega$ and $\qm$, the $\widetilde{\beta}_j^{\qm}$ are also continuous with respect to $\omega$ and $\qm$.
For each fixed $\qm$, the matrix $\mathfrak{M}_\qm$ is analytic and so has at least one zero eigenvalue at those $z$ for which there exists a $w\in\complex^{\abs{\vertSet}}\setminus\clbracs{0}$ such that
\begin{align} \label{eq:QGGenEvalSolveNoPoles}
	\mathfrak{M}_\qm\bracs{z}w = 0.
\end{align}
We could also chose to determine these $z$ via solution to 
\begin{align} \label{eq:QGDetSolveCondition}
	\det\mathfrak{M}_\qm\bracs{z} &= 0,
\end{align}
the merits of each approach (via \eqref{eq:QGGenEvalSolveNoPoles} or \eqref{eq:QGDetSolveCondition}) we will discuss in section \ref{ssec:ApproachConsiderations}.
If $z_0$ solves \eqref{eq:QGGenEvalSolveNoPoles} (or equivalently \eqref{eq:QGDetSolveCondition}), then $M_{\qm}\bracs{z_0}-B\bracs{z_0}$ has a zero eigenvalue when
\begin{align} \label{eq:EigenvalueBranchLimit}
	\lim_{z\rightarrow z_0} \beta_j^{\qm}\bracs{z} = \lim_{z\rightarrow z_0} \bracs{ H^{(2)}\bracs{z} }^{-1} \widetilde{\beta}_j^{\qm}\bracs{z} = 0
\end{align}
for at least one $j$ with $\widetilde{\beta}_j^{\qm}\bracs{z_0}=0$.
Checking the limit in \eqref{eq:EigenvalueBranchLimit} is not necessary for all solutions $z_0$ to \eqref{eq:QGDetSolveCondition}; provided that $H^{(2)}\bracs{z_0}\neq 0$, which by corollary \ref{cory:M-MatrixEntriesNoPoles} occurs when
\begin{align} \label{eq:H2ZerosEqn}
	z_0 \neq \bracs{ \frac{n\pi}{l_{jk}} }^2, \quad j\conLeft k, \ n\in\naturals_{0},
\end{align}
the limit in \eqref{eq:EigenvalueBranchLimit} is clearly zero and so $z_0$ belongs to the spectrum of \eqref{eq:SingularWaveEqnQGProblem}.
As we will discuss in section \ref{ssec:ApproachConsiderations}, one may be able to circumvent checking the limit \eqref{eq:EigenvalueBranchLimit} by exploiting \eqref{eq:TP-DenseQMSubsetSuffices}.
Considerations concerning which of the two equations \eqref{eq:QGGenEvalSolveNoPoles} or \eqref{eq:QGDetSolveCondition} should be used for determining the spectrum $\sigma_\qm$ are also discussed in section \ref{ssec:ApproachConsiderations}.
In any event, \eqref{eq:SingularScalarWaveEqn} has now been reduced to a more accessible (family of) matrix-eigenvalue problems for $\mathfrak{M}_\qm$.

\subsection{Artificial Vertices and Splitting Edges} \label{ssec:ArtificialVertices}
As noted in section section \ref{ssec:MMatrix}, it is required that the underlying graph $\graph$ contains no looping edges and has all edge-lengths pairwise irrationally-related.
Failure to ensure that this condition is met may result in the ``loss" of certain eigenvalues when using the $M$-matrix to determine the spectrum of \eqref{eq:SingularWaveEqnQGProblem} --- these are highlighted explicitly in section \ref{ssec:Example1DLoop}.
Of course, the graphs motivated by physical applications generally do not adhere to these restrictions, so it is necessary to introduce \emph{artificial} or \emph{dummy} vertices.
These artificial vertices split edges of the original graph, removing any loops and ensuring all (new) edges have irrationally-related lengths.

Introducing an artificial vertex to split an edge is as intuitive as it sounds --- suppose $\graph=\bracs{\vertSet, \edgeSet}$ and one wishes to split the edge $I_{jk}$ (where it may be the case that $j=k$).
Place a vertex $v_l$ at some point along the edge $I_{jk}$, and replace $I_{jk}$ with the edges $I_{jl}$ and $I_{lk}$, to obtain a new graph $\graph^*$.
The total length of the edges must be preserved, so $l_{jk} = l_{jl} + l_{lk}$, but the lengths of the new edges should be chosen in accordance with the requirements above in mind.
Furthermore, a zero coupling constant should be placed at the artificial vertex $v_l$ --- this ensures matching of the solution $u$ and its derivative at the artificial vertex, as would have been the case along the original edge if it had not been split.
The quasi-momentum parameters should also satisfy $\qm_{jl}=\qm_{lk}=\qm_{jk}$ (although this is a by-product of having straight edges, see assumption \ref{ass:MeasTheoryProblemSetup}).
This ensures (via \eqref{eq:SingularWaveEqnQGProblem-2} and \eqref{eq:SingularWaveEqnQGProblem-3}) that any eigenvalues $\omega^2$ of \eqref{eq:SingularWaveEqnQGProblem} on $\graph^*$ are also eigenvalues of \eqref{eq:SingularWaveEqnQGProblem} on $\graph$, with the eigenfunction $u^{(jk)}$ being related to $u^{(jl)}$ and $u^{(lk)}$ in the obvious manner.
This process can be iterated, splitting edges iteratively to remove rational-relations between edge lengths, and any loops themselves.
Doing so means that any graph representing a singular-structure can now be treated in the manner described in section \ref{ssec:MMatrixConsequences}.

\subsection{Considerations for the Approach to Solving \eqref{eq:QGGenEvalSolveNoPoles} or \eqref{eq:QGDetSolveCondition}} \label{ssec:ApproachConsiderations}
In this section we briefly discuss some considerations for recovering the spectrum $\sigma\bracs{-\laplacian_{\upsilon}}=:\sigma$, through determination the spectra $\sigma_{\qm}:=\sigma\bracs{-\laplacian_{\dddmes}^{\qm}}$ via \eqref{eq:QGGenEvalSolveNoPoles} or \eqref{eq:QGDetSolveCondition}.
Recall that our use of the Gelfand transform informs us that $\sigma = \bigcup_{\qm}\sigma_{\qm}$.
We also take as a baseline that one has to hand an appropriate numerical scheme for handling the generalised eigenvalue problem \eqref{eq:QGGenEvalSolveNoPoles} (a good introduction to which can be found in \cite{guttel2017nonlinear}), and so do not delve into the details of how such an algorithm would operate.
It is however worth mentioning that $\mathfrak{M}_\qm$ is Hermitian, from which most numerical schemes benefit.
%\tstk{move to introduction when we first talk about band-gap spectra?}
%There are also several known results concerning the spectra of (periodic) quantum graphs, and here we highlight those most relevant to our context. 
%A detailed discussion of the spectral structure of (periodic) quantum graphs, including statements (and proofs) of the results cited here, can be found in \cite[Chapter 4]{berkolaiko2013introduction}.
%We have already mentioned that it is known that $\sigma$ possesses a band-gap structure \cite[Chapter 4.3]{berkolaiko2013introduction}; there exist real numbers $a_j, b_j, j\in\naturals$ such that $\sigma = \bigcup_{j\in\naturals}\sqbracs{a_j,b_j}$.
%%The \emph{spectral bands} are the intervals $I_j=\sqbracs{a_j,b_j}, \ j\in\naturals$, with the regions between $b_j$ and $a_{j+1}$ being referred to as \emph{spectral gaps}, where there are no eigenvalues.
%%For this reason the points $a_j$ and $b_j$ sometimes referred to as the \emph{spectral edges}, and in general $a_j\rightarrow\infty$ as $j\rightarrow\infty$.
%Knowing that $\sigma$ has a band-gap representation is particularly useful when attempting to use either \eqref{eq:QGGenEvalSolveNoPoles} or \eqref{eq:QGDetSolveCondition} to determine it, which we will touch on shortly.
%%Other notable results are that $\sigma$ has no singular continuous part (\cite[Chapter 4.4]{berkolaiko2013introduction}) but may have non-empty pure-point part (\cite[Chapter 4.5]{berkolaiko2013introduction}) --- a non-empty pure-point spectrum implies the existence of a compactly supported eigenfunction for the graphs considered in this work.

Using corollary \ref{cory:M-MatrixEntriesNoPoles}, the following proposition can be proved.
\begin{prop} \label{prop:MMatrixDetForm}
	Given a graph $\graph = \bracs{\vertSet, \edgeSet}$ containing no loops, there exists a function $F\bracs{\qm,\omega}$ such that
	\begin{align} \label{eq:MMatrixDetForm}
		\det\mathfrak{M}_\qm\bracs{\omega^2} = \bracs{ \omega H^{(2)}\bracs{\omega^2} }^{\abs{\vertSet}-2} F\bracs{\qm,\omega}.
	\end{align}
	Furthermore, $F\bracs{\qm,\omega}$ is analytic in both its arguments.
\end{prop}
A proof of this result can be found in section \ref{sec:ProofOfProp}, but essentially involves counting the number of times a given factor can appear in the expression for the determinant.
Note that a graph with only one vertex can \emph{only} have looping edges, which must be broken via an artificial vertex to produce a graph with (at least two) vertices.

The zero level set of the function $F$, that is the preimage $F^{-1}\bracs{\clbracs{0}}$, determines majority of the spectrum --- in particular, the ``width" of the spectral bands.
More precisely, it determines $\sigma$ up to the roots of the prefactor $\bracs{ \omega H^{(2)}\bracs{\omega^2} }^{\abs{\vertSet}-2}$ in \eqref{eq:MMatrixDetForm}:
\begin{cory}
	Adopt the assumptions and notation of proposition \ref{prop:MMatrixDetForm}.
	Define the sets
	\begin{align*}
		F_0^{\qm} := \clbracs{\omega \setVert F\bracs{\qm, \omega}=0},
		\qquad
		F_0 := \bigcup_{\qm\in B}F_0^{\qm},
		\qquad
		H_0 := \clbracs{\omega \setVert H^{(2)}\bracs{\omega^2}=0}.
	\end{align*}		
	Then it holds that
	\begin{enumerate}[(i)]
		\item $F_0\setminus H_0 = \sigma\setminus H_0$,
		\item $\overline{F_0\setminus H_0} \subset \sigma$.
	\end{enumerate}
\end{cory}
\begin{proof}
	\begin{enumerate}[(i)]
		\item This follows from the relation $\widetilde{\beta}_j^{\qm} = H^{(2)}\beta_j^\qm$.
		Clearly if $\omega_0\in F_0\setminus H_0$, there exists some $\qm\in B$ such that $F\bracs{\qm,\omega_0}=0$, and so proposition \ref{prop:MMatrixDetForm} implies that $\det\mathfrak{M}_\qm\bracs{\omega_0^2}=0$.
		So there is in particular one eigenvalue branch $\widetilde{\beta}_j^{\qm}$ with $\widetilde{\beta}_j^{\qm}\bracs{\omega_0^2}=0$, hence $\beta_j^\qm\bracs{\omega_0^2}=0$ too, so $\omega_0\in\sigma$.
		Conversely, if $\omega_0\in \sigma\setminus H_0$, there exists some $\qm\in B$ and an eigenvalue branch with $\beta_j^\qm\bracs{\omega_0^2}=0$.
		Since $\omega_0\not\in H_0$, $\widetilde{\beta}_j^{\qm}\bracs{\omega_0^2}=0$ too, so $\det\mathfrak{M}_{\qm}\bracs{\omega_0^2}=0$, and thus by proposition \ref{prop:MMatrixDetForm} so is $F\bracs{\qm,\omega_0}$.
		\item By (i), $F_0\setminus H_0 \subset \sigma$.
		Therefore, $\overline{F_0\setminus H_0}\subset\overline{\sigma}=\sigma$, since the spectrum $\sigma$ is closed.
		\tstk{can also prove this by taking $\omega_0$ and appealing to a approx. sequence $\omega_n,\qm_n$ and noting that the product of the eigenvalue branches, hence determinant, is zero for each pair, so $\omega_n\in\sigma$ and thus the limit is too.}
	\end{enumerate}
\end{proof}
Corollary \ref{cory:M-MatrixEntriesNoPoles} demonstrates that the majority of the spectrum can thus be found through examination of the function $F$.
It is even unnecessary to check \eqref{eq:EigenvalueBranchLimit} for $\omega_0\in H_0$ provided this $\omega_0$ also lies in the closure of $F_0\setminus H_0$.
However, all other values satisfying \eqref{eq:H2ZerosEqn} must be checked through \eqref{eq:EigenvalueBranchLimit} to determine whether the corresponding $\omega$ form part of $\sigma$.

Finding $\sigma$ (up to checking roots of $H^{(2)}$) now becomes a question of obtaining $F_0$ efficiently.
There is always the ``brute-force" approach of computing $F_0^{\qm}$ for each $\qm$ (or for each $\qm$ in a suitable mesh if working numerically), and then take the union over $\qm$ to obtain $F_0$.
However some alternatives are available if $F$ admits additional properties, however these will rely on our ability to find an analytic expression for $F$ (one is obtained in the proof of proposition \ref{prop:MMatrixDetForm}, however it is rather cumbersome to use).
The ideal case being when we can write $F\bracs{\qm,\omega} = F_1\bracs{\qm} - F_2\bracs{\omega}$ for continuous $F_1$ and $F_2$, then \eqref{eq:QGDetSolveCondition} implies $F_0$ can be found simply by examining
\begin{align*}
	\min_{\qm}\clbracs{F_1(\qm)} \leq F_2\bracs{\omega} \leq \max_{\qm}\clbracs{F_1(\qm)},
\end{align*} 
although such a separation of $F$ will not generally be possible.
Of course, if an analytic expression for $F$ can be obtained, we can always then employ a root-finding algorithm to determine the set $F_0$.
Further to this, (the proof of) proposition \ref{prop:MMatrixDetForm} informs us that an explicit expression for $F$ will be in terms of $\omega^2$, sine and cosine functions of $\omega$, and complex exponentials in $\qm$.
Indeed, if one so chooses, $F$ can even be evaluated numerically through the formula given in section \ref{sec:ProofOfProp}.

Whilst we can discuss in the abstract methods for determining $\sigma$ through the function $F$, we should not ignore the elephant in the room concerning \emph{how practical} it is to work with the function $F$ in the first place.
As can be seen from corollary \ref{cory:M-MatrixEntriesNoPoles}, the complexity of the entries of $\mathfrak{M}_{\qm}$ (and thus the determinant in \eqref{eq:QGDetSolveCondition} and $F$) increases as one adds additional vertices and edges.
The complexity of the off-diagonal entries $\bracs{\mathfrak{M}_\qm}_{jk}$ depends on the number of edges between the vertices $v_j$ and $v_k$, whilst the complexity of the diagonal entries depends on the degree of the vertex $v_j$.
Furthermore, the sparsity of $\mathfrak{M}_\qm$ depends on the number of pairs of vertices that are not (directly) connected by an edge.
With this in mind, the ratio $\frac{\abs{\edgeSet}}{\abs{\vertSet}}$ can be a good indicator of ``how sparse" $\mathfrak{M}_\qm$ is, and how difficult $\mathfrak{M}_\qm$ will be to work with.
If $\frac{\abs{\edgeSet}}{\abs{\vertSet}}\approx 1$, then the number of non-zero entries in any row (or column) of $\mathfrak{M}_\qm$ should be approximately 2 --- the diagonal entry plus the entry corresponding to the expected single connection of this vertex.
At the extremes, $\frac{\abs{\edgeSet}}{\abs{\vertSet}}\approx 0$ corresponds to an almost-diagonal $\mathfrak{M}_\qm$, whilst $\frac{\abs{\edgeSet}}{\abs{\vertSet}}\approx \abs{\vertSet}$ corresponds to an almost-dense $\mathfrak{M}_\qm$.
A sparse $\mathfrak{M}_\qm$ is efficient to work with numerically, although if $\abs{\vertSet}$ is large can still be difficult to work with analytically.
For denser $\mathfrak{M}_\qm$, one begins to lean toward numerical schemes based on \eqref{eq:QGGenEvalSolveNoPoles}, as the expressions involved in \eqref{eq:QGDetSolveCondition} become increasingly cumbersome, and determining the function $F$ explicitly corresponding difficult.
This leads to the colloquial rule that solving \eqref{eq:QGDetSolveCondition} (analytically) is generally manageable for graphs with a ``small number" of edges and/or vertices, whilst graphs with a large number of edges and/or vertices often warrant solution via \eqref{eq:QGGenEvalSolveNoPoles} --- ff course, the cut-off for the terms ``small number" and ``large number" will depend on the person (or program) solving the problem themselves!

Another topical question worth addressing at this point is whether, given the expectation that $\sigma$ has a band-gap structure, an alternative to finding all $\omega\in F_0$ is to only compute the spectral edges $a_j, b_j$ and then reconstruct $F_0$ from them.
It is known for (second order) periodic PDE problems that the edges of the spectrum occur at the symmetry values of the quasi-momentum --- those values of $\qm$ which correspond to the periodic and anti-periodic problems (in each axis direction) on the unit cell.
If the above statement were true for the problem \eqref{eq:SingularWaveEqnQGProblem}, then the dimensionality of the problem of computing $F_0$ (hence $\sigma$) could be reliably reduced to determining $F_0^\qm$ for the aforementioned symmetry values of $\qm$.
However as discussed in \cite[Chapter 4.6]{berkolaiko2013introduction}, whilst this has been experimentally observed to be true for most motivated quantum graph problems based on physical topologies, it is in fact untrue in general for (standard) quantum graph problems.
As such, it is unlikely to be true for \eqref{eq:SingularWaveEqnQGProblem}; despite this however, \cite[Chapter 4.6]{berkolaiko2013introduction} remarks that adopting this approach of assuming the spectral edges lie at the symmetry points of the quasi-momentum doesn't often lead to errors in practice when concerned with quantum graph problems, although it is unclear why.
The ``working hypothesis" or ``rule of thumb" is that the period graph needs to be made (very) asymmetric to move the spectral edges away from the symmetry points of the quasi-momentum, and since most physical structures of interest display symmetries in their unit cells, the statement appears to be ``true in practice".
In our examples in section \ref{sec:ScalarExamples}, we will also see that preserving some underlying symmetries in our graphs indeed results in the symmetry values of the quasi-momentum being the boundaries of the spectral gaps.

%The discussion in the previous paragraph focused on obtaining $\sigma$ and $\sigma_\qm$ via the solution to \eqref{eq:QGDetSolveCondition}.
%Here we discuss some situations where it is more appropriate to use \eqref{eq:QGGenEvalSolveNoPoles} to determine $\sigma_{\qm}$ (and thus $\sigma$), although the discussion concerning the determination of the spectral edges $a_j, b_j$ is still applicable to solution methods that work via \eqref{eq:QGGenEvalSolveNoPoles}.
%If one is looking to numerically solve for $\sigma_\qm$, then the default choice should be to solve the generalised eigenvalue problem \eqref{eq:QGGenEvalSolveNoPoles}.
%Eigenvalue-finding schemes usually benefit from knowing that $\mathfrak{M}_\qm$ is Hermitian, and \eqref{eq:QGGenEvalSolveNoPoles} avoids having to work with $\det\mathfrak{M}_\qm$ --- which is generally advisable when handling matrices numerically. 
%On the other hand, if one is willing to perform some analytic work, solving via \eqref{eq:QGDetSolveCondition} offers the possibility of finding an expression for $\det\mathfrak{M}_\qm$ in terms of rational functions ($\sin, \cos$, etc) on which less expensive numerical schemes can be used, or determining $\sigma_\qm$ outright.
%As such, the choice of approach largely depends on how willing the solver is to work analytically with $\mathfrak{M}_\qm$.
%With this in mind, corollary \ref{cory:M-MatrixEntriesNoPoles} tells us that the complexity of the entry of $\bracs{\mathfrak{M}_\qm}_{jk}$ depends on the number of edges between the vertices $v_j$ and $v_k$, whilst the complexity of the diagonal entries depends on the degree of the vertex $v_j$.
%Furthermore, the number of vertices in the graph determines the dimensions of $\mathfrak{M}_\qm$, and the sparsity of $\mathfrak{M}_\qm$ depends on the number of pairs of vertices that are not (directly) connected by an edge.
%This leads to the colloquial rule that solving \eqref{eq:QGDetSolveCondition} (analytically) is generally manageable for graphs with a ``small number" of edges and/or vertices, whilst graphs with a large number of edges and/or vertices often warrant solution via \eqref{eq:QGGenEvalSolveNoPoles}.
%Of course, the cut-off for the terms ``small number" and ``large number" will depend on the person (or program) solving the problem themselves!
%With this in mind, the ratio $\frac{\abs{\edgeSet}}{\abs{\vertSet}}$ can also be a good indicator the ``sparsity" of $\mathfrak{M}_\qm$, and thus how difficult $\mathfrak{M}_\qm$ will be to work with.
%If $\frac{\abs{\edgeSet}}{\abs{\vertSet}}\approx 1$, then the number of non-zero entries in any row (or column) of $\mathfrak{M}_\qm$ should be approximately 2 --- the diagonal entry plus the entry corresponding to the expected single connection of this vertex.
%At the extremes, $\frac{\abs{\edgeSet}}{\abs{\vertSet}}\approx 0$ corresponds to an almost-diagonal $\mathfrak{M}_\qm$, whilst $\frac{\abs{\edgeSet}}{\abs{\vertSet}}\approx \abs{\vertSet}$ corresponds to an almost-dense $\mathfrak{M}_\qm$.
%A sparse $\mathfrak{M}_\qm$ can be easy to handle analytically and efficient to work with numerically, even if $\abs{\vertSet}$ is relatively large.
%For denser $\mathfrak{M}_\qm$, one likely begins to lean toward numerical schemes, as the expressions involved in \eqref{eq:QGDetSolveCondition} becomes increasingly cumbersome.