\section{Sobolev Spaces with Respect to Borel Measures} \label{sec:BorelMeasSobSpaces}
In this section we introduce the ``non-classical" Sobolev spaces with respect to Borel measures, the final ingredient that we require to pose variational problems on our singular structures.
Since we will be working with a number of different measures (section \ref{sec:SingularMeasures}) in two dimensions (or occasionally three), the content of this section is presented with respect to a general Borel measure $\rho$ defined on (a subset of) $\reals^2$.
Let $\ddom\subset\reals^2$, and denote by $\smooth{\ddom}$ the set of infinitely differentiable (\emph{smooth}) functions on $\ddom$ (uniformly extended to the boundary if applicable), $\csmooth{\ddom}$ the set of smooth functions with compact support within $\ddom$, and $\psmooth{\ddom}$ the set of infinitely differentiable functions on $\reals^2$ that are $\ddom$-periodic.
Let $\rho$ be a Borel measure on $\ddom$, and denote by $\ltwo{\ddom}{\rho}$ the space of $\rho$-square-integrable functions on $\ddom$.
Our overarching goal is to construct an analogy to a Sobolev space for the measure $\rho$, and hence obtain a concept of (weak) derivative.
We will predominantly work ``post-Gelfand transform", hence our definitions will involve the shifted gradient ($\ktgrad$) and curl operators ($\ktcurl{}$) operators introduced in section \ref{sec:TP-GelfandTransform}.
Section \ref{ssec:SobSpacesAndGelfand} clarifies the relationship between the spaces we introduce here and the non-classical Sobolev spaces one would consider when studying a periodic problem in $\reals^2$.
\tstk{also need the whole ``periodic, but can ignore b/c graphs" remark, although this might go in the first appendix to chapter 3}

Let us begin by defining
\begin{align*}
	W^{\kt}_{\rho,\mathrm{grad}} &:= \overline{\clbracs{ \bracs{\phi, \ktgrad\phi} \setVert \phi\in\psmooth{\ddom} }},
\end{align*}
where the closure is taken in $\ltwo{\ddom}{\rho}\times\ltwo{\ddom}{\rho}^3$, and 
\begin{align*}
	W^{\kt}_{\rho,\mathrm{curl}} &:= \overline{\clbracs{ \bracs{\Phi, \ktcurl{}\Phi} \setVert \Phi\in\bracs{\psmooth{\ddom}}^3 }},
\end{align*}
where the closure is taken in $\ltwo{\ddom}{\rho}^3\times\ltwo{\ddom}{\rho}^3$.
This mimics the ``$H$"-definition of classical Sobolev spaces (when $\rho$ is the Lebesgue measure), however for general measures $\rho$ the Meyers-Serrin ``$H=W$" theorem (see \cite[Theorem 3.17]{adams2003sobolev}) doesn't hold due to the lack of the integration by parts technique. \tstk{but there is a partial integration by parts technique for our S-spaces on graphs, could include in an appendix if we wanted. In fact, it's very useful for our discussion about Zhikov's result!}
We would like to call the second element of a pair $\bracs{u,g}\in W^{\kt}_{\rho,\mathrm{grad}}$ ``the gradient" of the function $u$, however notice that if $\bracs{u,g_1}, \bracs{0, g_2}\in W^{\kt}_{\rho,\mathrm{grad}}$ then we also have that $\bracs{u, g_1+g_2}\in W^{\kt}_{\rho,\mathrm{grad}}$.
As such, the term ``gradient" being used in reference to the second element of a pair in $W^{\kt}_{\rho,\mathrm{grad}}$ does not indicate a unique function --- both $g_1$ and $g_1+g_2$ are ``gradients" of $u$ in this sense.
An analogous deduction can be made for ``curl" and the second member of elements of $W^{\kt}_{\rho,\mathrm{curl}}$.
The non-uniqueness of ``gradients" (in the aforementioned sense) is not a major hindrance \tstk{Zhikov, Kirill \& Serena's homogenisation papers deal with this fine)}, but it requires us to define and study the set of ``($\rho$)-gradients of zero" as
\begin{align*}
	\gradZero{\ddom}{\rho} &= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\kt}_{\rho,\mathrm{grad}}}, \\
	&= \clbracs{ g\in\ltwo{\ddom}{\rho}^3 \setVert \exists\phi_n\in\psmooth{\ddom} \text{ s.t. } \phi_n \lconv{\ltwo{\ddom}{\rho}}0, \ktgrad\phi_n\lconv{\ltwo{\ddom}{\rho}^3} g }, \labelthis\label{eq:GradZeroSequenceDef}
\end{align*}
and analogously define the set of ``($\rho$)-curls of zero" as
\begin{align*}
	\curlZero{\ddom}{\rho} &= \clbracs{ c\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,c}\in W^{\kt}_{\rho,\mathrm{curl}}}, \\
	&= \clbracs{ c\in\ltwo{\ddom}{\rho}^3 \setVert \exists\Phi^n\in\psmooth{\ddom}^3 \text{ s.t. } \Phi^n\lconv{\ltwo{\ddom}{\rho}^3}0, \ \ktcurl{}\Phi\lconv{\ltwo{\ddom}{\rho}^3} c}. \labelthis\label{eq:CurlZeroSequenceDef}
\end{align*}
Given an element $g\in\gradZero{\ddom}{\rho}$, we will refer to a sequence $\phi_n$ as in \eqref{eq:GradZeroSequenceDef} as an ``approximating sequence" for $g$, and will make use of the phrase ``take an approximating sequence $\phi_n$ for $g$" (or similar) to mean ``let $\phi_n$ be a sequence as in \eqref{eq:GradZeroSequenceDef} for the element $g$ of $\gradZero{\ddom}{\rho}$".
We also adopt a similar convention for elements $c\in\curlZero{\ddom}{\rho}$ and ``approximating sequences" as in \eqref{eq:CurlZeroSequenceDef}.
The functions that belong to these sets can be thought of as the functions that are changing (or vector fields that are rotating) in such a way that the measure $\rho$ cannot see these changes, whilst the Lebesgue measure can --- concrete interpretations for the measures we study in depth can be found in \tstk{appendices with curl and gradient interpretations, including curls on line segments and planes}.

One may notice the absence of any $\kt$ labelling on the sets $\gradZero{\ddom}{\rho}$ and $\curlZero{\ddom}{\rho}$, which is due to their independence of these quantities, as demonstrated in proposition \ref{prop:ZeroInvariantUnderQM-Wavenumber} below.
This is not unexpected --- given that $\phi_n$ converging to zero, adding $\phi_n$ multiplied by a combination of the quasi-momentum $\qm$ and Fourier variable $\wavenumber$ is not going to change any behaviour.
\begin{prop} \label{prop:ZeroInvariantUnderQM-Wavenumber}
	Fix a wavenumber $\wavenumber$ and a quasi-momentum $\qm$, and let
	\begin{align*}
		\mathcal{G}_{\ddom,\md\rho}^{\kt}(0) &:= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\kt}_\mathrm{grad} }, \\
		\gradZero{\ddom}{\rho} &:= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\bracs{0, 0}}_\mathrm{grad} }, \\
		\mathcal{C}_{\ddom,\md\rho}^{\kt}(0) &:= \clbracs{ c\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,c}\in W^{\kt}_\mathrm{curl} }, \\
		\curlZero{\ddom}{\rho} &:= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\bracs{0, 0}}_\mathrm{curl} }.
	\end{align*}
	Then the following sets are equal:
	\begin{align*}
		\mathcal{G}_{\ddom,\md\rho}^{\kt}(0) &= \gradZero{\ddom}{\rho}, \\
		\mathcal{C}_{\ddom,\md\rho}^{\kt}(0) &= \curlZero{\ddom}{\rho}.
	\end{align*}
\end{prop}
\begin{proof}
	This is seen by observing that for $\phi\in\psmooth{\ddom}$ and $\Phi\in\psmooth{\ddom}^3$,
	\begin{align*}
		\grad^{\kt}\phi &= \grad^{\bracs{0, 0}}\phi + \rmi\wavenumber\begin{pmatrix} 0 \\ 0 \\ \phi \end{pmatrix} + \rmi\begin{pmatrix} \qm_1 \\ \qm_2 \\ 0 \end{pmatrix}\phi, \\
		\grad^{\kt}\wedge\Phi &= \grad^{\bracs{0, 0}}\wedge\Phi + \rmi\wavenumber\begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}\wedge\Phi + \rmi\begin{pmatrix} \qm_1 \\ \qm_2 \\ 0 \end{pmatrix} \wedge \Phi.
	\end{align*}
	Thus, if $g\in \mathcal{G}_{\ddom,\md\rho}^{\kt}(0)$ there exists a sequence $\phi_n\in\smooth{\ddom}$ such that
	\begin{align*}
		\phi_n \lconv{\ltwo{\ddom}{\rho}} 0, &\quad \ktgrad\phi_n \lconv{ \ltwo{\ddom}{\rho}^3 } g,
	\end{align*}
	(as in \eqref{eq:GradZeroSequenceDef}).
	But $\rmi\bracs{\qm_1, \qm_2, 0}^{\top}\phi_n\rightarrow 0$, as does $\rmi\wavenumber\phi_n$.
	Given the formulae above, we must also have that $\grad^{\bracs{0, 0}}\phi_n\rightarrow g$, so $g\in \gradZero{\ddom}{\rho}$.
	The reverse implication, and the proof for $\rho$-curls of zero, is similar.
\end{proof}

Another useful property of the sets $\gradZero{\ddom}{\rho}$ and $\curlZero{\ddom}{\rho}$ is that they are closed, linear subspaces of $\ltwo{\ddom}{\rho}^3$.
\begin{prop}
	The sets $\gradZero{\ddom}{\rho}$ and $\curlZero{\ddom}{\rho}$ are closed, linear subspaces of $\ltwo{\ddom}{\rho}^3$.
\end{prop}
\begin{proof}
	We only present the proof for $\gradZero{\ddom}{\rho}$, since the proof for $\curlZero{\ddom}{\rho}$ is analogous.
	
	The fact that $\gradZero{\ddom}{\rho}$ is a subspace follows from its definition; if $g, h\in\gradZero{\ddom}{\rho}$ take approximating sequences $\phi_n$, $\psi_n$ for $g,h$ respectively.
	Then for any $\alpha\in\complex$, we have that $\alpha\phi_n + \psi_n\in\psmooth{\ddom}$ too, and clearly
	\begin{align*}
		\alpha\phi_n + \psi_n &\lconv{\ltwo{\ddom}{\rho}} \alpha\times 0 + 0 = 0, \\
		\ograd\bracs{\alpha\phi_n + \psi_n} &= \alpha\ograd\phi_n + \ograd\psi_n
		\lconv{\ltwo{\ddom}{\rho}^3} \alpha g + h,
	\end{align*}
	so $\alpha g + h\in\gradZero{\ddom}{\rho}$.
	
	Next we prove that $\gradZero{\ddom}{\rho}$ is closed, through a diagonal argument.
	To this end, let $g_n$ be a sequence in $\gradZero{\ddom}{\rho}$ that converges (in $\ltwo{\ddom}{\rho}^3$) to some function $g$.
	For each $n\in\naturals$, there exists an approximating sequence of (periodic) smooth functions $\phi_n^l$ for $g_n$ since each $g_n\in\gradZero{\ddom}{\rho}$.
	Now, let $m\in\naturals$.
	Since $g_n\rightarrow g$, there exists $N_m\in\naturals$ such that $\norm{g_n-g}_{\ltwo{\ddom}{\rho}^3}<\recip{2m}$ for all $n\geq N_m$ --- in particular, $g_{N_m}$ satisfies this inequality.
	Then, since $\phi_{N_m}^l$ is an approximating sequence for $g_{N_m}$, we have that there exist $L_{N_m}^{(1)}, L_{N_m}^{(2)}\in\naturals$ such that
	\begin{align*}
		\norm{\phi_{N_m}^l}_{\ltwo{\ddom}{\rho}} < \recip{m}, &\quad\forall l\geq L_{N_m}^{(1)}, \\
		\norm{\ograd\phi_{N_m}^l - g_{N_m}}_{\ltwo{\ddom}{\rho}^3} < \recip{2m}, &\quad\forall l\geq L_{N_m}^{(2)}.
	\end{align*}	 
	Set $L_{N_m} = \max\clbracs{ L_{N_m}^{(1)}, L_{N_m}^{(2)} }$, and define $\psi_m = \phi^{L_{N_m}}_{N_m}$ for each $m$.
	Then we have that
	\begin{align*}
		\norm{\psi_m}_{\ltwo{\ddom}{\rho}} &= \norm{\phi_{N_m}^{L_{N_m}}}_{\ltwo{\ddom}{\rho}} < \recip{m}, \\
		\norm{\ograd\psi_m - g}_{\ltwo{\ddom}{\rho}^3} &= \norm{\ograd\phi_{N_m}^{L_{N_m}} - g}_{\ltwo{\ddom}{\rho}^3} \\
		&\leq \norm{\ograd\phi_{N_m}^{L_{N_m}} - g_{N_m}} + \norm{g_{N_m} - g}_{\ltwo{\ddom}{\rho}^3} \\
		&< \recip{2m} + \recip{2m} = \recip{m}.
	\end{align*}
	Therefore,
	\begin{align*}
		\psi_m \lconv{\ltwo{\ddom}{\rho}} 0, \quad \ograd\psi_m \lconv{\ltwo{\ddom}{\rho}^3} g,
	\end{align*}
	and each $\psi_m\in\psmooth{\ddom}$, and so $g\in\gradZero{\ddom}{\rho}$.
\end{proof}

Since $\gradZero{\ddom}{\rho}$ is a closed, linear subspace of $\ltwo{\ddom}{\rho}^3$ we have the direct sum decomposition
\begin{align*}
	\ltwo{\ddom}{\rho}^3 = \gradZero{\ddom}{\rho}^{\perp} \oplus \gradZero{\ddom}{\rho}.
\end{align*}
Now suppose that we have $\bracs{u,g_1}, \bracs{u,g_2}\in W^{\kt}_{\rho,\mathrm{grad}}$ with $g_1, g_2\in\gradZero{\ddom}{\rho}^\perp$.
This implies there exist approximating sequences $\phi_n, \psi_n$ such that
\begin{align*}
	\phi_n \lconv{\ltwo{\ddom}{\rho}} u, &\quad \psi_n \lconv{\ltwo{\ddom}{\rho}} u, \\
	\ktgrad\phi_n \lconv{\ltwo{\ddom}{\rho}^3} g_1, &\quad \ktgrad\psi_n \lconv{\ltwo{\ddom}{\rho}^3} g_2.
\end{align*}
Since $g_1, g_2\in \gradZero{\ddom}{\rho}^{\perp}$, we have that $g_1-g_2\in \gradZero{\ddom}{\rho}^{\perp}$ too.
However, 
\begin{align*}
	\phi_n - \psi_n \lconv{\ltwo{\ddom}{\rho}} 0, &\quad \ktgrad\bracs{\phi_n-\psi_n} \lconv{\ltwo{\ddom}{\rho}^3} g_1 - g_2,
\end{align*}
so $g_1 - g_2\in \gradZero{\ddom}{\rho}$ too --- therefore we must have that $g_1=g_2$.
With this in mind, we see that each $u$ possesses a unique gradient \emph{that is orthogonal to} $\gradZero{\ddom}{\rho}$.
This allows construction of the \emph{non-classical} Sobolev space of gradients with respect to the measure $\rho$:
\begin{definition}[Sobolev Space of $\kt$-Gradients] \label{def:3DGradSobSpace}
	The set
	\begin{align*}
		\ktgradSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktgrad_{\rho}u}\in W^{\kt}_{\rho,\mathrm{grad}} \setVert \ktgrad_{\rho}u \perp \gradZero{\ddom}{\rho} },
	\end{align*}
	is called the \emph{Sobolev space of $\kt$-gradients with respect to the measure $\rho$}.
	We call the member $\ktgrad_{\rho}u$ of the pair $\bracs{u, \ktgrad_{\rho}u}\in\ktgradSob{\ddom}{\rho}$ the \emph{$\kt$-tangential gradient of $u$ with respect to $\rho$}.
	When the context is clear, we will simply refer to $\ktgrad_{\rho}u$ as the \emph{tangential gradient} or \emph{$\kt$-tangential gradient}.
	Additionally, it is enough to specify the first member $u$ of the pair $\bracs{u, \ktgrad_{\rho}u}$ due to the uniqueness of $\kt$-tangential gradients, so we will often write $u\in\ktgradSob{\ddom}{\rho}$ as shorthand.
	\tstk{We can equip $\ktgradSob{\ddom}{\rho}$ with the inner product and norm
	\begin{align*}
		\ip{u}{v}_{\ktgradSob{\ddom}{\rho}} 
		&= \integral{\ddom}{u\overline{v}}{\rho}
		+ \integral{\ddom}{\ktgrad_{\rho}u \cdot \overline{\ktgrad_{\rho}v}}{\rho}, \\
		\norm_{\ktgradSob{\ddom}{\rho}}^2 &= \ip{u}{u}_{\ktgradSob{\ddom}{\rho}}
		= \norm{u}_{\ltwo{\ddom}{\rho}}^2 + \norm{\ktgrad_{\rho}u}_{\ltwo{\ddom}{\rho}^3},
	\end{align*}		
	to make it a Hilbert space.}
\end{definition}

We can also perform analogous steps for $\curlZero{\ddom}{\rho}$, which allows us to define the \emph{Sobolev space of curls} with respect to the measure $\rho$:
\begin{definition}[Sobolev Space of $\kt$-Curls] \label{def:CurlSobSpace}
	The set
	\begin{align*}
		\ktcurlSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktcurl{\rho}u}\in W^{\kt}_{\rho,\mathrm{curl}} \setVert \ktcurl{\rho}u \perp \curlZero{\ddom}{\rho} },
	\end{align*}
	is called the \emph{Sobolev space of $\kt$-curls with respect to the measure $\rho$}.
	The member $\ktcurl{\rho}u$ of the pair $\bracs{u, \ktcurl{\rho}u}$ is the \emph{$\kt$-tangential curl of $u$ with respect to $\rho$}.
\end{definition}
Like with tangential gradients; we will use the shorthand $u\in\ktcurlSob{\ddom}{\rho}$ to refer to the element $\bracs{u, \ktcurl{\rho}u}\in\ktcurlSob{\ddom}{\rho}$, since each $u$ has a unique $\ktcurl{\rho}u$ that is orthogonal to $\curlZero{\ddom}{\rho}$, and when the context is clear will refer to $\ktcurl{\rho}u$ as the \emph{tangential curl} or \emph{$\kt$-tangential curl}.
\tstk{norm as well?}

%Having now assigned a meaning to (tangential) gradients and curls for the measure $\rho$, we can also define what it means for a vector field $u$ to be $\kt$-divergence-free with respect to $\rho$.
%\begin{definition}[$\kt$-divergence-free] \label{def:ktDivFree}
%	A vector field $u\in\ltwo{\ddom}{\rho}^3$ is said to be \emph{$\kt$-divergence-free} (with respect to $\rho$) if
%	\begin{align*}
%		0 &= \integral{\ddom}{ u\cdot\overline{g} }{\rho}, \qquad\forall\bracs{v,g}\in W^{\kt}_{\rho,\mathrm{grad}}.
%	\end{align*}
%\end{definition}
%We have setup divergence-free vector fields to be those that are orthogonal (in $\ltwo{\ddom}{\rho}^3$) to all gradients of $\ltwo{\ddom}{\rho}$-functions, including gradients of zero.
%\tstk{Helmholtz decomp stuff, L2\_Decomposition.pdf. Might go at end with the other div-free result? Also might want to save this for the Maxwell chapter discussion to flesh out that chapter, as it's a focal point there (even though we can prove the statements in general for $\rho$).}

Having provided the definition of the Sobolev spaces that we will later be considering, we provide some simple results which will prove useful throughout our analysis.
By construction, functions with tangential gradients or curls can also be approximated by smooth functions.
\begin{cory} \label{cory:SobSpaceApproxSequences}
	\begin{align*}
		\ktgradSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktgrad_{\rho}u} \setVert \exists\phi_n\in\psmooth{\ddom} \text{ s.t. } \right. \\ 
		&\hspace{0.25\textwidth} \left. \phi_n\lconv{\ltwo{\ddom}{\rho}}u, \ \ktgrad\phi_n\lconv{\ltwo{\ddom}{\rho}^3}\ktgrad_{\rho}u }, \\
		\ktcurlSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktcurl{\rho}u} \setVert \exists\Phi^n\in\psmooth{\ddom}^3 \text{ s.t. } \right. \\
		&\hspace{0.25\textwidth} \left. \Phi^n\lconv{\ltwo{\ddom}{\rho}^3}u, \ \ktcurl{}\Phi^n\lconv{\ltwo{\ddom}{\rho}^3}\ktgrad_{\rho}u }.
	\end{align*}
\end{cory}
\begin{proof}
	This is a direct consequence of the construction of $W^{\kt}_{\rho,\mathrm{grad}}$ and $W^{\kt}_{\rho,\mathrm{curl}}$.
\end{proof}
We will adopt analogous terminology and phrasing when using sequences $\phi_n$ and $\Phi^n$ as they appear in corollary \ref{cory:SobSpaceApproxSequences} to that used for sequences in \eqref{eq:GradZeroSequenceDef}-\eqref{eq:CurlZeroSequenceDef} regarding gradients and curls of zero --- referring to them as \emph{approximating sequences} for elements of $\ktgradSob{\ddom}{\rho}$ or $\ktcurlSob{\ddom}{\rho}$.

Given our choice to construct (tangential) gradients and curls via approximation, we retain the rule that the curl of a gradient is 0 --- once translated into its analogue for gradients and curls with respect to the measure $\rho$.
\begin{lemma} \label{lem:CurlOfGradSmoothFunctions}
	For $\phi\in\psmooth{\ddom}$, we have that
	\begin{align*}
		\ktcurl{}\bracs{\ktgrad\phi} = 0.
	\end{align*}
\end{lemma}
\begin{proof}
	Let $\phi\in\psmooth{\ddom}$, $\Phi = \ktgrad\phi$, and set $\widetilde{\qm} = \bracs{\qm_1, \qm_2, 0}^\top$ throughout.
	Notice that
	\begin{align*}
		\Phi = \ktgrad\phi &= \e^{-\rmi\qm\cdot x}\kgrad\bracs{ \e^{\rmi\qm\cdot x}\phi },
	\end{align*}
	so with $\psi = \e^{\rmi\qm\cdot x}\phi$, we have that
	\begin{align*}
		\ktcurl{}\Phi 
		&= \kgrad\wedge\bracs{ \Phi } + \rmi\widetilde{\qm}\wedge\Phi
		= -\rmi\widetilde{\qm}\wedge\Phi + \e^{-\rmi\qm\cdot x}\kgrad\wedge\psi + \rmi\widetilde{\qm}\wedge\Phi \\
		&= \e^{-\rmi\qm\cdot x}\kgrad\wedge\psi
		= \e^{-\rmi\qm\cdot x} 
		\begin{pmatrix}
			\partial_2\bracs{ \rmi\wavenumber \e^{\rmi\qm\cdot x}\phi } - \rmi\wavenumber\partial_2\bracs{ \e^{\rmi\qm\cdot x}\phi } \\
			\rmi\wavenumber\partial_1\bracs{ \e^{\rmi\qm\cdot x}\phi } - \partial_1\bracs{ \rmi\wavenumber \e^{\rmi\qm\cdot x}\phi } \\
			\partial_1\bracs{ \partial_2\bracs{\rmi\wavenumber\e^{\rmi\qm\cdot x}\phi} } - \partial_2\bracs{ \partial_1\bracs{\rmi\wavenumber\e^{\rmi\qm\cdot x}\phi} }
		\end{pmatrix} \\
		&= 0.
	\end{align*}
\end{proof}

Since our definitions of $\gradZero{\ddom}{\rho}, \curlZero{\ddom}{\rho}$ and tangential gradients and curls all depend on approximations by smooth functions, lemma \ref{lem:CurlOfGradSmoothFunctions} informs us that adding a gradient to an existing vector field will not change the curl of said vector field.
\begin{prop} \label{prop:CurlIgnoresGradients}
	Suppose that $u\in\ktcurlSob{\ddom}{\rho}$, $g\in\gradZero{\ddom}{\rho}$, $w\in\ktgradSob{\ddom}{\rho}$ and set $v = u + g + w\in\ltwo{\ddom}{\rho}^3$. 
	Then $\bracs{v, \ktcurl{\rho}u}\in\ktcurlSob{\ddom}{\rho}$ --- that is, $v$ has a tangential $\kt$-curl equal to that of $u$.
\end{prop}
\begin{proof}
	Take an approximating sequence $\Phi^n$ for $u$ as in corollary \ref{cory:SobSpaceApproxSequences}, $\phi_n$ for $w$ as in  corollary \ref{cory:SobSpaceApproxSequences}, and $\psi_n$ for $g$ as in \eqref{eq:GradZeroSequenceDef}.
	Define $\varphi^n := \Phi^n + \ktgrad\phi_n + \ktgrad\psi_n\in\psmooth{\ddom}^3$ for each $n\in\naturals$.
	Given lemma \ref{lem:CurlOfGradSmoothFunctions}, we have that $\ktcurl{}\varphi^n = \ktcurl{}\Phi^n$ for every $n\in\naturals$.
	Therefore, we have that
	\begin{align*}
		\varphi^n &\lconv{\ltwo{\ddom}{\rho}^3} u + w + g = v, \\
		\ktcurl{}\varphi^n &= \ktcurl{}\Phi^n 
		\lconv{\ltwo{\ddom}{\rho}^3} \ktcurl{\rho}u.
	\end{align*}
	Thus, we conclude that $\bracs{v, \ktcurl{\rho}u}\in W^{\kt}_{\rho, \mathrm{curl}}$.
	Since $\ktcurl{\rho}u\in\curlZero{\ddom}{\rho}^\perp$, we must conclude that $\bracs{ v, \ktcurl{\rho}u }\in\ktcurlSob{\ddom}{\rho}$ too.
\end{proof}
In particular, proposition \ref{prop:CurlIgnoresGradients} informs us that the $\kt$-tangential curl of either a $\kt$-tangential gradient, or a gradient of zero, is zero.
%
%Another remark that deserves to be made is that given the construction of $W^{\kt}_{\rho,\mathrm{grad}}$, it is sufficient to only test orthogonality of $u$ against smooth gradients when checking if a field is divergence free.
%\begin{cory} \label{cory:DivFreeSufficient}
%	If
%	\begin{align*}
%		0 &= \integral{\ddom}{ u\cdot\overline{\ktgrad\phi} }{\rho}, \qquad\forall\phi\in\psmooth{\ddom},
%	\end{align*}
%	then $u$ is $\kt$-divergence free with respect to $\rho$.
%\end{cory}
%\begin{proof}
%	If $\bracs{v,g}\in W^{\kt}_{\rho,\mathrm{grad}}$ take an approximating sequence as in \eqref{eq:GradZeroSequenceDef}.
%	Then clearly
%	\begin{align*}
%		\integral{\ddom}{ u\cdot\overline{g} }{\rho} 
%		&= \lim_{n\rightarrow\infty}\integral{\ddom}{ u\cdot\overline{\ktgrad\phi_n} }{\rho}
%		= \lim_{n\rightarrow\infty} 0 = 0.
%	\end{align*}
%\end{proof}
%Corollary \ref{cory:DivFreeSufficient} does mean that definition \ref{def:ktDivFree} could be weakened, however we chose to present the definition of divergence free in this manner to maintain parallels to the usual intuition of a divergence free field being orthogonal to \emph{all} gradients.

\subsection{Other Sobolev Spaces, and the image under the Gelfand Transform} \label{ssec:SobSpacesAndGelfand}
One can define analogous ``non-classical" Sobolev spaces on $\reals^d$ (or subsets thereof) through an analogous procedure to the above; let $\upsilon$ be a Borel measure on $\reals^d$ and define \tstk{check: you need compactly supported smooth functions here right? Otherwise they're not going to be sufficiently fast decaying!}
\begin{align*}
	W_{\upsilon,\mathrm{grad}} := \overline{ \clbracs{ \bracs{\phi, \grad\phi} \setVert \phi\in\csmooth{\reals^d} } },
\end{align*}
with the closure taken in $\ltwo{\reals^d}{\upsilon}\times\ltwo{\reals^d}{\upsilon}^d$.
One can again define a set of gradients of zero, demonstrate that it forms a closed linear subspace of $\ltwo{\reals^d}{\upsilon}^d$, and construct the Sobolev space $\gradSob{\reals^d}{\upsilon}$ consisting of functions $u$ and their tangential gradients $\grad_{\upsilon}u$ --- for further information, the interested reader can see \tstk{Zhikov, with section ref}.
We can also define the Sobolev space $\tgradSob{\ddom}{\rho}$ via the same procedure by first considering the closure of pairs $\bracs{\phi, \tgrad\phi}, \phi\in\psmooth{\ddom}$ in $\ltwo{\ddom}{\rho}\times\ltwo{\ddom}{\rho}^2$.

Upon recalling section \ref{sec:TP-GelfandTransform}, the reader may notice that our notation and construction of the Sobolev spaces $\ktgradSob{\ddom}{\rho}$ and $\ktcurlSob{\ddom}{\rho}$ is heavily suggestive of being the result of the combination of a Gelfand transform in the first two coordinate directions and a Fourier transform in the third.
Indeed, our choice to use periodic smooth functions and the shifted gradient operator to construct these spaces was not a coincidence.
Now suppose that $\hat{\graph}$ is a periodic graph embedded into $\reals^2$ with period cell $\ddom$, and let $\upsilon$ be one of the singular measures detailed in section \ref{sec:SingularMeasures} with respect to the graph $\hat{\graph}$.
Let $\graph$ be the period graph of $\hat{\graph}$ and let $\rho$ be the ``restriction" of the measure $\upsilon$ to $\ddom$.
Finally, consider the extrusion $\dddom:=\hat{\graph}\times[0,\infty)\subset\reals^3$ equipped with the product measure $\upsilon\times\lambda_1$, and the image of the set
\begin{align*}
	\clbracs{ \bracs{\phi, \grad\phi} \setVert \phi\in\csmooth{\dddom} }
\end{align*}
under a Gelfand transform in the $\bracs{x_1,x_2}$-plane and a Fourier transform in the $x_3$ plane.
For given quasi-momentum $\qm$ and Fourier variable (wavenumber) $\kappa$, the resulting functions belong to the set
\begin{align*}
	\clbracs{ \bracs{\phi, \ktgrad\phi} \setVert \phi\in\psmooth{\ddom} }.
\end{align*}
By virtue of how we chose to construct the space $\gradSob{\dddom}{\bracs{\upsilon\times\lambda_1}}$, we have that the image of a function $u\in\gradSob{\dddom}{\bracs{\upsilon\times\lambda_1}}$ will be some $\hat{u}\in\ktgradSob{\ddom}{\rho}$.
Similar conclusions can be drawn for the spaces $\curlSob{\dddom}{\bracs{\upsilon\times\lambda_1}}$ and $\ktcurlSob{\ddom}{\rho}$ and the spaces $\gradSob{\reals^2}{\upsilon}$ and $\tgradSob{\ddom}{\rho}$.